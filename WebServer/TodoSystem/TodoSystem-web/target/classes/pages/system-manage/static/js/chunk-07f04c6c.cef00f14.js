(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-07f04c6c"],{"22c6":function(e,t,o){"use strict";o.d(t,"b",(function(){return a})),o.d(t,"c",(function(){return i})),o.d(t,"e",(function(){return n})),o.d(t,"a",(function(){return s})),o.d(t,"d",(function(){return l}));var r=o("b775");function a(e){return Object(r["a"])({url:"/admin/employee/selectByExample",method:"post",data:e})}function i(e){return Object(r["a"])({url:"/admin/employee/add",method:"post",data:e})}function n(e){return Object(r["a"])({url:"/admin/employee/update",method:"post",data:e})}function s(e){return Object(r["a"])({url:"/admin/employee/delete",method:"post",data:e})}function l(e){return Object(r["a"])({url:"/admin/employeeRole/batchAdd",method:"post",data:e})}},"363e":function(e,t,o){"use strict";o.r(t);var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-dialog",{attrs:{title:e.dialogTitle,visible:e.isVisible,width:"35%",top:"5vh","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.isVisible=t}}},[o("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"所属公司",prop:"empOperId"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",filterable:""},on:{change:e.getOperatorName},model:{value:e.form.empOperId,callback:function(t){e.$set(e.form,"empOperId",t)},expression:"form.empOperId"}},e._l(e.operatorList,(function(e){return o("el-option",{key:e.operId,attrs:{label:e.operName,value:e.operId}})})),1)],1),o("el-form-item",{attrs:{label:"人员账号",prop:"empAccount"}},[o("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.empAccount,callback:function(t){e.$set(e.form,"empAccount",t)},expression:"form.empAccount"}},[o("template",{slot:"prepend"},[e._v(e._s(e.operCode))])],2)],1),e.isEdit?e._e():o("el-form-item",{attrs:{label:"人员密码",prop:"empPassword"}},[o("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.empPassword,callback:function(t){e.$set(e.form,"empPassword",t)},expression:"form.empPassword"}})],1),o("el-form-item",{attrs:{label:"人员姓名",prop:"empName"}},[o("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.empName,callback:function(t){e.$set(e.form,"empName",t)},expression:"form.empName"}})],1),o("el-form-item",{attrs:{label:"人员编号",prop:"empNumber"}},[o("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.empNumber,callback:function(t){e.$set(e.form,"empNumber",t)},expression:"form.empNumber"}})],1),o("el-form-item",{attrs:{label:"联系方式",prop:"empPhone"}},[o("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.empPhone,callback:function(t){e.$set(e.form,"empPhone",t)},expression:"form.empPhone"}})],1),o("el-form-item",{attrs:{label:"状态"}},[o("el-switch",{staticStyle:{"margin-right":"5px"},attrs:{"active-color":"#13ce66","active-value":1,"inactive-color":"#909399","inactive-value":0},model:{value:e.form.empStatus,callback:function(t){e.$set(e.form,"empStatus",t)},expression:"form.empStatus"}}),e.form.empStatus?o("el-tag",{attrs:{size:"small",type:"success"}},[e._v("在职")]):o("el-tag",{attrs:{size:"small",type:"info"}},[e._v("离职")])],1)],1),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.roleLoading,expression:"roleLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.roleList,"tooltip-effect":"dark",border:"",height:"260"},on:{"selection-change":e.handleSelectionChange}},[o("el-table-column",{attrs:{align:"center",type:"selection",width:"60"}}),o("el-table-column",{attrs:{prop:"roleName",label:"角色名称"}})],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.isVisible=!1}}},[e._v("取 消")]),o("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.submitting,expression:"submitting"}],attrs:{type:"primary",disabled:e.submitting},on:{click:function(t){return e.submitClick()}}},[e._v("确 定")])],1)],1)],1)},a=[],i=o("5530"),n=(o("ac1f"),o("1276"),o("159b"),o("99af"),o("a15b"),o("d81d"),o("ad78")),s=o("22c6"),l=o("f1b9"),m=o("61f7"),c=o("2f62"),p={name:"EditDialog",mixins:[n["a"]],props:{entity:{type:Object},operatorList:{type:Array}},data:function(){return{submitting:!1,form:{empId:"",empAccount:"",empPassword:"",empNumber:"",empName:"",empPhone:"",empStatus:1,empOperId:"",empOperName:""},rules:{empAccount:[{required:!0,message:"人员账号不能为空！",trigger:"blur"}],empName:[{required:!0,message:"人员姓名不能为空！",trigger:"blur"}],empNumber:[{required:!0,message:"人员编号不能为空！",trigger:"blur"}],empPassword:[{required:!0,message:"人员密码不能为空！",trigger:"blur"}],empPhone:[{required:!0,validator:m["e"],trigger:"blur"}],empOperId:[{required:!0,message:"人员公司不能为空！",trigger:"change"}]},roleList:[],roleLoading:!1,chooseList:[],operCode:""}},watch:{entity:function(e){if(e&&e.empId){if(this.form.empId=e.empId,this.form.empPassword=e.empPassword,this.form.empNumber=e.empNumber,this.form.empName=e.empName,this.form.empPhone=e.empPhone,this.form.empStatus=e.empStatus,this.form.empOperId=e.empOperId,this.form.empOperName=e.empOperName,this.getOperatorName(e.empOperId),e.empAccount){var t=[];t=e.empAccount.split("".concat(this.operCode)),this.form.empAccount=t[t.length-1]}this.getAllRoles()}else this.form={empId:"",empAccount:"",empPassword:"",empNumber:"",empName:"",empPhone:"",empStatus:1,empOperId:this.operatorInfo.operId,empOperName:this.operatorInfo.operName},this.getOperatorName(this.operatorInfo.operId),this.getAllRoles()}},computed:Object(i["a"])(Object(i["a"])({},Object(c["b"])(["operatorInfo"])),{},{isEdit:function(){return this.entity&&this.entity.empId},dialogTitle:function(){return this.isEdit?"编辑":"添加"}}),methods:{getOperatorName:function(e){var t=this,o="";this.operatorList.forEach((function(r){r.operId==e&&(o=r.operName,t.operCode=r.operCode)})),this.form.empOperName=o,this.getAllRoles()},getAllRoles:function(){var e=this;this.roleLoading=!0,Object(l["d"])({empId:this.form.empId,"param.roleOperId":this.form.empOperId,page:1,limit:0}).then((function(t){e.roleLoading=!1;var o=t.root||[];e.roleList=o;var r=[];o.forEach((function(t,o){t.empHave&&setTimeout((function(){e.$refs.multipleTable.toggleRowSelection(e.roleList[o]),r.push(t)}),1)})),e.chooseList=r}))},handleSelectionChange:function(e){this.chooseList=e},submitClick:function(){var e=this,t=this.chooseList;t.length<1?this.$notify({title:"提示",message:"请选择一个角色!",type:"warning"}):this.$refs.form.validate((function(t){if(t){var o=Object(i["a"])({},e.form);e.isEdit||(o.empAccount="".concat(e.operCode).concat(o.empAccount)),e.submitting=!0,(e.isEdit?Object(s["e"])(o):Object(s["c"])(o)).then((function(t){e.submitting=!1,t.success?e.setRoles(e.isEdit?o.empId:t.tip):e.$notify.error({title:"失败",message:t.failReasonShow||(e.isEdit?"修改信息失败":"新增信息失败")})})).catch((function(t){e.submitting=!1;try{e.$notify.error({title:"发生错误",message:"错误: ".concat(t.response.statusCode,", ").concat(t.response.statusText)})}catch(o){e.$notify.error({title:"发生错误",message:"错误: ".concat(JSON.stringify(t))})}}))}}))},setRoles:function(e){var t=this,o=this.chooseList;Object(s["d"])({empId:e,roleIds:o.map((function(e){return e.roleId})).join(",")}).then((function(e){t.submitting=!1,e.success?(t.$emit("change"),t.isVisible=!1,t.$refs["form"].resetFields()):t.$notify.error({title:"失败",message:e.failReasonShow||(t.isEdit?"修改信息失败":"新增信息失败")})})).catch((function(e){t.submitting=!1;try{t.$notify.error({title:"发生错误",message:"错误: ".concat(e.response.statusCode,", ").concat(e.response.statusText)})}catch(o){t.$notify.error({title:"发生错误",message:"错误: ".concat(JSON.stringify(e))})}}))}}},u=p,d=o("2877"),f=Object(d["a"])(u,r,a,!1,null,"0a0a6958",null);t["default"]=f.exports},"8a44":function(e,t,o){"use strict";o.r(t);var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"list-view-layout"},[o("json-filter",{attrs:{code:e.titleCode}},[o("el-form",{attrs:{inline:!0}},[o("el-form-item",{attrs:{label:"人员姓名"}},[o("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.param.empNameIsLike,callback:function(t){e.$set(e.param,"empNameIsLike",t)},expression:"param.empNameIsLike"}})],1),o("el-form-item",{attrs:{label:"联系方式"}},[o("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.param.empPhoneIsLike,callback:function(t){e.$set(e.param,"empPhoneIsLike",t)},expression:"param.empPhoneIsLike"}})],1),o("el-form-item",[o("el-button",{on:{click:function(t){return e.doSearch()}}},[e._v("查询")]),o("permission-filter",{attrs:{code:"permissionEmployeeAdd",type:"primary"},nativeOn:{click:function(t){return e.doAdd()}}})],1)],1)],1),o("json-table",{ref:"myJsonTable",attrs:{"table-heads":e.tableHeads,loading:e.listLoading,"table-data":e.tableData,page:e.page},on:{"current-change":e.currentPageChange},scopedSlots:e._u([{key:"empStatus",fn:function(t){return[1==t.rowData.scope.row.empStatus?o("el-tag",{attrs:{size:"small",type:"success"}},[e._v("在职")]):0==t.rowData.scope.row.empStatus?o("el-tag",{attrs:{size:"small",type:"info"}},[e._v("离职")]):o("el-tag",{attrs:{size:"small",type:"info"}},[e._v("未知")])]}},{key:"empDbCreateTime",fn:function(t){return[o("span",[e._v(" "+e._s(e._f("formatDate")(t.rowData.scope.row.empDbCreateTime,"yyyy-MM-dd hh:mm"))+" ")])]}},{key:"operations",fn:function(t){return[o("permission-filter",{attrs:{code:"permissionEmployeeEdit",size:"mini",type:"warning"},nativeOn:{click:function(o){return e.doEdit(t.rowData.scope.row)}}}),o("permission-filter",{attrs:{code:"permissionEmployeeDel",size:"mini",type:"danger"},nativeOn:{click:function(o){return e.doDelete(t.rowData.scope.row)}}})]}}])}),o("edit-dialog",{attrs:{entity:e.chooseEntity,"operator-list":e.operatorList},on:{change:function(t){return e.handleChange()}},model:{value:e.dialogShow,callback:function(t){e.dialogShow=t},expression:"dialogShow"}})],1)},a=[],i=o("5530"),n=o("4303"),s=o("261a"),l=o("e101"),m=o("363e"),c=o("22c6"),p=o("b775");function u(e){return Object(p["a"])({url:"/admin/operator/selectByExample",method:"post",data:e})}var d={components:{JsonFilter:n["a"],JsonTable:s["a"],PermissionFilter:l["a"],EditDialog:m["default"]},filters:{},data:function(){return{titleCode:"permissionEmployee",tableHeads:[{prop:"empAccount",label:"人员账号"},{prop:"empName",label:"人员姓名"},{prop:"empNumber",label:"人员编号"},{prop:"empPhone",label:"联系方式"},{prop:"roleNames",label:"角色"},{prop:"empOperName",label:"所属公司"},{slot:!0,prop:"empStatus",label:"状态"},{slot:!0,prop:"empDbCreateTime",width:160,label:"创建时间"},{slot:!0,fixed:"right",prop:"operations",label:"操作",width:160}],listLoading:!1,tableData:[],param:{empNameIsLike:"",empPhoneIsLike:""},page:{limit:15,current:1,total:15},dialogShow:!1,chooseEntity:null,operatorList:[]}},computed:{},created:function(){},methods:{getOperatorList:function(){var e=this;u({limit:0,page:1}).then((function(t){t.success?e.operatorList=t.root:e.operatorList=[]}))},getTableData:function(){var e=this;this.listLoading=!0,Object(c["b"])(Object(i["a"])(Object(i["a"])({},this.param),{},{orderItem:"emp_db_create_time",orderType:"desc",page:this.page.current,limit:this.page.limit,isHaveRoleName:"Y"})).then((function(t){e.listLoading=!1,t.success?(e.tableData=t.root,e.page.total=t.totalSize):(e.tableData=[],e.page.total=15,e.$notify({title:"提示",message:t.failReasonShow||"未获取到数据",type:"warning"}))}))},currentPageChange:function(e){this.page.current=e,this.getTableData()},doSearch:function(){this.page.current=1,this.getTableData()},doDelete:function(e){var t=this;this.$confirm("确定删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",beforeClose:function(o,r,a){"confirm"===o?Object(c["a"])({id:e.empId}).then((function(e){e.success?(t.$notify({title:"成功",message:"操作成功!",type:"success"}),t.getTableData()):t.$notify.error({title:"失败",message:e.failReasonShow||"操作失败"}),a()})).catch((function(e){t.$notify.error({title:"失败",message:"请求发生错误， 请重试"}),a()})):a()}})},handleChange:function(){this.getTableData()},doAdd:function(){this.chooseEntity=null===this.chooseEntity?{}:null,this.dialogShow=!0},doEdit:function(e){this.chooseEntity=e,e.uniquelyIdentifies=(new Date).getTime(),this.dialogShow=!0}}},f=d,h=o("2877"),b=Object(h["a"])(f,r,a,!1,null,"397ffdfc",null);t["default"]=b.exports},f1b9:function(e,t,o){"use strict";o.d(t,"d",(function(){return a})),o.d(t,"e",(function(){return i})),o.d(t,"h",(function(){return n})),o.d(t,"a",(function(){return s})),o.d(t,"g",(function(){return l})),o.d(t,"c",(function(){return m})),o.d(t,"f",(function(){return c})),o.d(t,"b",(function(){return p}));var r=o("b775");function a(e){return Object(r["a"])({url:"admin/role/selectByExample",method:"post",data:e})}function i(e){return Object(r["a"])({url:"/admin/role/add",method:"post",data:e})}function n(e){return Object(r["a"])({url:"/admin/role/update",method:"post",data:e})}function s(e){return Object(r["a"])({url:"/admin/role/delete",method:"post",data:e})}function l(e){return Object(r["a"])({url:"/admin/permission/settingPermissionToRole",method:"post",data:e})}function m(e){return Object(r["a"])({url:"/admin/permission/selectByExample",method:"post",data:e})}function c(e){return Object(r["a"])({url:"/admin/miniRolePermission/setting",method:"post",data:e})}function p(e){return Object(r["a"])({url:"/admin/miniRolePermission/selectByExample",method:"post",data:e})}}}]);