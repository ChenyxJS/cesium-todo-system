(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-28f8719d"],{2627:function(e,t,a){},"2cbb":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a("b775");function o(e){return Object(r["a"])({url:"/admin/auditRecord/audit",method:"post",data:e})}},"67ea":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.isVisible,width:"40%",top:"4vh","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.isVisible=t}}},[null!==e.entity?a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"auto",rules:e.rules}},[a("el-form-item",{attrs:{label:"学校码："}},[a("el-input",{attrs:{readonly:""},model:{value:e.entity.aureOrgId,callback:function(t){e.$set(e.entity,"aureOrgId",t)},expression:"entity.aureOrgId"}})],1),a("el-form-item",{attrs:{label:"学校名称："}},[a("el-input",{attrs:{readonly:""},model:{value:e.entity.aureOrgName,callback:function(t){e.$set(e.entity,"aureOrgName",t)},expression:"entity.aureOrgName"}})],1),a("el-form-item",{attrs:{label:"用户姓名："}},[a("el-input",{attrs:{readonly:""},model:{value:e.entity.userRealName,callback:function(t){e.$set(e.entity,"userRealName",t)},expression:"entity.userRealName"}})],1),a("el-form-item",{attrs:{label:"手机号："}},[a("el-input",{attrs:{readonly:""},model:{value:e.entity.userPhone,callback:function(t){e.$set(e.entity,"userPhone",t)},expression:"entity.userPhone"}})],1),a("el-form-item",{attrs:{label:"类型："}},[a("el-tag",{attrs:{type:"success"}},[e._v("权限管理审核")])],1),a("el-form-item",{attrs:{label:"调整前角色:"}},[null!==e.entity.aureChangeBefore?a("el-input",{attrs:{readonly:""},model:{value:e.entity.aureChangeBefore.roleName,callback:function(t){e.$set(e.entity.aureChangeBefore,"roleName",t)},expression:"entity.aureChangeBefore.roleName"}}):e._e()],1),a("el-form-item",{attrs:{label:"调整后角色:"}},[null!==e.entity.aureChangeAfter?a("el-input",{attrs:{readonly:""},model:{value:e.entity.aureChangeAfter.roleName,callback:function(t){e.$set(e.entity.aureChangeAfter,"roleName",t)},expression:"entity.aureChangeAfter.roleName"}}):e._e()],1),a("el-form-item",{attrs:{label:"调整时间："}},[a("el-date-picker",{attrs:{type:"datetime",readonly:""},model:{value:e.entity.aureUpdateTime,callback:function(t){e.$set(e.entity,"aureUpdateTime",t)},expression:"entity.aureUpdateTime"}})],1),a("el-form-item",{attrs:{label:"审核："}},[a("el-switch",{staticStyle:{"margin-right":"5px"},attrs:{"active-color":"#13ce66","active-value":1,"inactive-color":"#909399","inactive-value":2},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}}),e.form.status?a("el-tag",{attrs:{size:"small",type:"success"}},[e._v("通过")]):a("el-tag",{attrs:{size:"small",type:"danger"}},[e._v("不通过")])],1),a("el-form-item",{attrs:{label:"备注：",prop:"remark"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入备注："},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),2===e.form.status?a("el-form-item",{attrs:{label:"请输入原因：",prop:"failReason"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入原因："},model:{value:e.form.failReason,callback:function(t){e.$set(e.form,"failReason",t)},expression:"form.failReason"}})],1):e._e()],1):e._e(),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.submitting,expression:"submitting"}],attrs:{type:"primary",disabled:e.submitting},on:{click:function(t){return e.audit()}}},[e._v("确定")])],1)],1)],1)},o=[],l=a("5530"),n=a("ad78"),i=a("2cbb"),s=a("2f62"),u={name:"AuditDialog",mixins:[n["a"]],props:{entity:{type:Object}},data:function(){return{submitting:!1,form:{status:1,id:"",failReason:"",remark:""},rules:{failReason:[{required:!0,message:"请输入审核失败原因",trigger:"blur"}]}}},computed:Object(l["a"])(Object(l["a"])({},Object(s["b"])(["userInfo"])),{},{dialogTitle:function(){return"学生信息审核"}}),watch:{entity:function(e){e&&e.aureId&&(this.form.id=e.aureId,this.form.status=1)}},methods:{audit:function(){var e=this;this.$refs.form.validate((function(t){if(t){var a=Object(l["a"])(Object(l["a"])({},e.form),{},{loginUserId:e.userInfo.userId});e.submitting=!0,Object(i["a"])(Object(l["a"])({},a)).then((function(t){e.submitting=!1,t.success?(e.$refs["form"].resetFields(),e.$notify({title:"成功",message:"操作成功",type:"success"}),e.$emit("change"),e.isVisible=!1):e.$notify.error({title:"失败",message:t.failReasonShow||"操作失败"})}))}}))}}},c=u,m=(a("8ecd"),a("2877")),f=Object(m["a"])(c,r,o,!1,null,"b6c6bb2c",null);t["default"]=f.exports},8928:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list-view-layout"},[a("json-filter",{attrs:{code:e.titleCode}},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"学校码"}},[a("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.param.schoolCode,callback:function(t){e.$set(e.param,"schoolCode",t)},expression:"param.schoolCode"}})],1),a("el-form-item",{attrs:{label:"学校名称"}},[a("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.param.schoolName,callback:function(t){e.$set(e.param,"schoolName",t)},expression:"param.schoolName"}})],1),a("el-form-item",{attrs:{label:"用户名称"}},[a("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.param.userName,callback:function(t){e.$set(e.param,"userName",t)},expression:"param.userName"}})],1),a("el-form-item",{attrs:{label:"用户手机号"}},[a("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.param.userPhone,callback:function(t){e.$set(e.param,"userPhone",t)},expression:"param.userPhone"}})],1),a("el-form-item",[a("el-button",{on:{click:function(t){return e.doSearch()}}},[e._v("查询")])],1)],1)],1),a("json-table",{ref:"myJsonTable",attrs:{"table-heads":e.tableHeads,loading:e.listLoading,"table-data":e.tableData,page:e.page},on:{"current-change":e.currentPageChange},scopedSlots:e._u([{key:"operations",fn:function(t){return[a("permission-filter",{attrs:{code:"businessPermissionAudit",size:"mini",type:"warning"},nativeOn:{click:function(a){return e.doAudit(t.rowData.scope.row)}}})]}},{key:"aureType",fn:function(t){return[a("el-tag",[e._v("权限管理审核")])]}},{key:"aureCreateTime",fn:function(t){return[a("span",[e._v(e._s(e._f("formatDate")(t.rowData.scope.row.aureCreateTime,"yyyy-MM-dd HH:mm:ss"))+" ")])]}},{key:"aureChangeBefore",fn:function(t){return[a("span",[e._v(e._s(e._f("filterRoleName")(t.rowData.scope.row.aureChangeBefore)))])]}},{key:"aureChangeAfter",fn:function(t){return[a("span",[e._v(e._s(e._f("filterRoleName")(t.rowData.scope.row.aureChangeAfter)))])]}},{key:"aureStatus",fn:function(t){return[0===t.rowData.scope.row.aureStatus?a("el-tag",{attrs:{type:"primary"}},[e._v("待审核")]):e._e(),1===t.rowData.scope.row.aureStatus?a("el-tag",{attrs:{type:"success"}},[e._v("通过")]):e._e(),2===t.rowData.scope.row.aureStatus?a("el-tag",{attrs:{type:"danger"}},[e._v("不通过")]):e._e()]}},{key:"aurePassedTime",fn:function(t){return[a("span",[e._v(e._s(e._f("formatDate")(t.rowData.scope.row.aurePassedTime,"yyyy-MM-dd HH:mm:ss"))+" ")])]}}])}),a("audit-dialog",{attrs:{entity:e.chooseEntity},on:{change:function(t){return e.handleChange()}},model:{value:e.dialogShow,callback:function(t){e.dialogShow=t},expression:"dialogShow"}})],1)},o=[],l=a("5530"),n=(a("159b"),a("4303")),i=a("261a"),s=a("e101"),u=a("67ea"),c=a("b775");function m(e){return Object(c["a"])({url:"/admin/auditRecord/selectRoleModifyRecord",method:"post",data:e})}var f={components:{JsonFilter:n["a"],JsonTable:i["a"],PermissionFilter:s["a"],AuditDialog:u["default"]},data:function(){return{titleCode:"businessPermission",tableHeads:[{prop:"aureOrgId",label:"学校码"},{prop:"aureOrgName",label:"学校名称",overflowTooltip:"show"},{prop:"userRealName",label:"用户姓名"},{prop:"userPhone",label:"手机号"},{slot:!0,prop:"aureType",label:"类型",width:120},{slot:!0,prop:"aureChangeBefore",label:"调整前角色"},{slot:!0,prop:"aureChangeAfter",label:"调整后角色"},{slot:!0,prop:"aureCreateTime",label:"调整时间"},{slot:!0,prop:"aureStatus",label:"审核状态"},{prop:"aureAuditUserName",label:"审核人"},{slot:!0,prop:"aurePassedTime",label:"审核时间"},{slot:!0,fixed:"right",prop:"operations",label:"操作",width:180}],listLoading:!1,tableData:[],param:{schoolCode:"",schoolName:"",userName:"",userPhone:""},page:{limit:15,current:1,total:15},dialogShow:!1,chooseEntity:null}},computed:{},filters:{filterRoleName:function(e){return e?e.roleName:""}},created:function(){this.getTableData()},methods:{getTableData:function(){var e=this;this.listLoading=!0,m(Object(l["a"])(Object(l["a"])({},this.param),{},{page:this.page.current,limit:this.page.limit})).then((function(t){e.listLoading=!1,t.success?(t.root.forEach((function(e){null!==e.aureChangeBefore&&null!==e.aureChangeAfter&&(e.aureChangeBefore=JSON.parse(e.aureChangeBefore),e.aureChangeAfter=JSON.parse(e.aureChangeAfter))})),e.tableData=t.root,e.page.total=t.totalSize):(e.tableData=[],e.page.total=0,e.$notify({title:"提示",message:t.failReasonShow||"未获取到数据",type:"warning"}))}))},currentPageChange:function(e){this.page.current=e,this.getTableData()},doSearch:function(){this.page.current=1,this.getTableData()},handleChange:function(){this.getTableData()},doAudit:function(e){this.chooseEntity=e,e.uniquelyIdentifies=(new Date).getTime(),this.dialogShow=!0}}},p=f,d=a("2877"),b=Object(d["a"])(p,r,o,!1,null,"5119c07c",null);t["default"]=b.exports},"8ecd":function(e,t,a){"use strict";a("2627")}}]);